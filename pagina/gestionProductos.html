<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenidos a Nuestra Tienda de Insumos Computacionales</title>
    <link rel="stylesheet" href="css/styleGestionProductos.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <header>
        <div class="logo-container">
            <a href="index.html">
                <img src="img/logoTech.png" class="foto">
            </a>
            <div class="title-container">
                <div class="logo">Tienda de Insumos Computacionales Chile</div>
                <a href="index.html" class="Logout-btn">Cerrar Sesion? :( </a>
            </div>
        </div>
        <nav>
            <ul>
                <li><a href="InicioAdmin.html">Inicio</a></li>
                <li><a href="Admin.html">Administracion</a></li>
                <li><a href="gestionProveedor.html">Gestion Proveedores</a></li>
            </ul>
        </nav>
    </header>
    <div class="Gestiones">
        <button onclick="window.location.href='Admin.html'">Volver</button>
    </div>
    <div class="titlePage">
        <h2>Gestion Productos</h2>
    </div>


    <div class="actions-container">
        <button class="btnAgregar" onclick="window.location.href = '/agregarProducto.html'">Agregar Producto</button>
    </div>

    
    <div class="card-container" id="productos-list"></div>
    
    <script>
        let cartCount = 0;
        window.onload = function () {
            fetch('/catalogo')
            .then(function(response) {
                return response.json();
            })
            .then(function(data) {
                var productsList = document.getElementById('productos-list');
                data.forEach(function(prod) {
                    var card = document.createElement('div');
                    card.classList.add('card');
                    card.style.width = '18rem';
                    card.innerHTML = 
                                     '<img src="/imagenes/' + prod.imagen + '" class="card-img-top" alt=">' +
                                     '<div class="card-body">' +
                                     '<h5 class="card-title">' + prod.nombreProducto + '</h5>' +
                                     '<p><strong>Stock:</strong> ' + prod.stock + '</p>' +
                                     '<p><strong>Precio:</strong> $' + prod.precioUnitario + '</p>' +
                                     '<button class="btn btn-success" onclick="modificarProducto(' + prod.IdProducto + ')">Modificar Producto</button>' +
                                     '<button class="btn btn-danger" onclick="confirmarEliminarProducto(' + prod.IdProducto + ')">Eliminar Producto</button>' +
                                     '</div>';
                    productsList.appendChild(card);
                });
            })
            .catch(function(error) {
                console.error('Error al cargar los productos:', error);
            });
        };
        function confirmarEliminarProducto(id) {
        if (confirm('¿Estás seguro de eliminar este producto?')) {
            eliminarProducto(id);
        }
    }

    function eliminarProducto(id) {
        fetch(`/eliminar_producto/${id}`, {
            method: 'DELETE'
        })
        .then(response => {
            if (response.ok) {
                console.log('Producto eliminado correctamente.');
                window.location.reload();
            } else {
                console.error('Error al eliminar producto.');
            }
        })
        .catch(error => {
            console.error('Error en la solicitud:', error);
        });
    }
    function modificarProducto(id) {
        window.location.href = '/modificarProducto.html?id=' + id;
    }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<footer id="contacto">
    <p>&copy; 2024 Tienda de Insumos Computacionales. Todos los derechos reservados.</p>
    <div class="registrarse-link">
        <h5>Consulte aca: <a href="contacto.html">Contacto</a></h5>
        <h6>Recuerde, nos pagan por ayudarle ;|</h6>
        
    </div>
</footer>
</body>
</html>