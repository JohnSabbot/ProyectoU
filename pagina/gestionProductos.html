<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenidos a Nuestra Tienda de Insumos Computacionales</title>
    <link rel="stylesheet" href="css/styleGestionProductos.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <header>
        <div class="logo-container">
            <a href="index.html">
                <img src="img/logoTech.png" class="foto">
            </a>
            <div class="title-container">
                <div class="logo">Tienda de Insumos Computacionales Chile</div>
                <a href="index.html" class="Logout-btn">Cerrar Sesion? :( </a>
            </div>
        </div>
        <nav>
            <ul>
                <li><a href="InicioAdmin.html">Inicio</a></li>
                <li><a href="Admin.html">Administracion</a></li>
                <li><a href="gestionProveedor.html">Gestion Proveedores</a></li>
            </ul>
        </nav>
    </header>
    <div class="Gestiones">
        <button onclick="window.location.href='Admin.html'">Volver</button>
    </div>
    <div class="titlePage">
        <h2>Gestion Productos</h2>
    </div>


    <div class="actions-container">
        <button class="btnAgregar" onclick="window.location.href = '/agregarProducto.html'">Agregar Producto</button>
    </div>

    

    <form action="/subir_imagenes" method="post" enctype="multipart/form-data">
        <label for="nombre">Nombre de la Foto:</label>
        <input type="text" id="nombre" name="nombre" required>
        <br><br>
        <label for="descripcion">Descripcion de la Foto:</label>
        <input type="text" id="descripcion" name="descripcion" required>
        <br><br>
        <label for="imagen">Selecciona la Foto:</label>
        <input type="file" id="imagen" name="imagen" required>
        <br><br>
        <input type="submit" value="Subir Imagen">
    </form>

    <div class="card-container" id="productos-list"></div>

    <h2>imagenes subidas</h2>
    <div id="imagenesSubidas">

    </div>

    <script>
        window.onload = function(){
            fetch('/imagenes')
            .then(response => response.json())
            .then(data =>{
                const imagenesDiv = document.getElementById('imagenesSubidas');
                data.forEach(imagen =>{
                    const imgDiv = document.createElement('div');
                    imgDiv.innerHTML =
                        '<h3>' + imagen.nombre + '</h3>' +
                        '<p>' + imagen.descripcion + '</p>'+
                        '<img src="/imagenes/' + imagen.imagen + '" alt="' + imagen.nombre + '" width="200">';
                    imagenesDiv.appendChild(imgDiv);
                });
            });
        };
    </script>


    <script>
        let cartCount = 0;
        window.onload = function () {
            fetch('/catalogo')
            .then(function(response) {
                return response.json();
            })
            .then(function(data) {
                var productsList = document.getElementById('productos-list');
                data.forEach(function(prod) {
                    var card = document.createElement('div');
                    card.classList.add('card');
                    card.style.width = '18rem';
                    card.innerHTML = 
                                     '<div class="card-body">' +
                                     '<h5 class="card-title">' + prod.nombreProducto + '</h5>' +
                                     '<p><strong>Stock:</strong> ' + prod.stock + '</p>' +
                                     '<p><strong>Precio:</strong> $' + prod.precioUnitario + '</p>' +
                                     '<button class="btn btn-success" onclick="modificarProducto()">Modificar Producto</button>' +
                                     '<button class="btn btn-danger" onclick="eliminarProducto(' + prod.id + ')">Eliminar Producto</button>' +
                                     '</div>';
                    productsList.appendChild(card);
                });
            });
        };
    </script>

<script>
    function eliminarProducto(id) {
        fetch('/eliminar_producto/' + id, {
            method: 'DELETE'
        })
        .then(function(response) {
            if (response.ok) {
                console.log('Producto eliminado correctamente.');
                window.location.reload();
            } else {
                console.error('Error al eliminar producto.');
            }
        })
        .catch(function(error) {
            console.error('Error en la solicitud:', error);
        });
    }

</script>

<script>
    function modificarProducto(id) {
        window.location.href = '/modificarProducto.html?id=' + id;
    }
</script>





    
<footer id="contacto">
    <p>&copy; 2024 Tienda de Insumos Computacionales. Todos los derechos reservados.</p>
    <div class="registrarse-link">
        <h5>Consulte aca: <a href="contacto.html">Contacto</a></h5>
        <h6>Recuerde, nos pagan por ayudarle ;|</h6>
        
    </div>
</footer>
</body>
</html>